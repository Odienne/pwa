import KEYS from"./KEYS.js";function searchImages(){const e=$(".js-searchQuery-value").val();if(!e)return;const s=`&query=${e}&per_page=9&orientation=squarish`,l="https://api.unsplash.com/search/photos?client_id="+KEYS.ACCESS_KEY+s;console.log(navigator.onLine),navigator.onLine?axios.get(l).then((s=>{const l=s.data;localforage.setItem(e,s.data),console.log("save data"),manageAndDisplayData(l,e)})).catch((e=>console.error("Error while fetching your images",e))):(console.log("fetch local data"),localforage.getItem(e).then((s=>{console.log(s),manageAndDisplayData(s,e)})))}function manageAndDisplayData(e,s){let l='<p>Aucun résultat pour la recherche <span class="font-weight-bold">"'+s+'"</span></p>',a="";e.results.length>0&&(l='<p>Voici les résultats de la recherche <span class="font-weight-bold">"'+s+'"</span></p>',e.results.map((e=>{console.log(e.urls.small);let s=e.urls.small.replace("https://images.unsplash.com","");console.log(s),caches.open("images").then((s=>{console.log(s);const l=[];s.keys().then((function(a){console.log(a),e.urls.small===a&&(console.log(a),console.log(e.urls.small===a),e.urls.small===a&&l.push(s.match(a)))})),console.log(l)}));let l=e.urls.small;navigator.onLine||(l=s);let t=new Date(e.created_at);a+='    <div class="col-md-4">\n                <div class="card thumbnail mb-4 shadow-sm">\n                   <img class="img-fluid" src="'+l+'" alt="'+e.description+'">\n                    <div class="card-body">\n                        <p class="card-text ellipsis">'+(e.description?e.description:e.alt_description?e.alt_description:"")+'\n                        </p>\n                        <div class="d-flex justify-content-between align-items-center">\n                            <small class="text-muted">'+t.getDate()+"/"+t.getMonth()+"/"+t.getFullYear()+"</small>\n                        </div>\n                    </div>\n                </div>\n            </div>\n"}))),$("#js-pwa-photos").html(a),$("#js-searchTitle").html(l),$(".pwa-spinner").hide()}$(document).ready((()=>{let e=$(".js-searchQuery");$(".js-searchQuery-value").keypress((s=>13===s.which?e.click():null)),e.on("click",searchImages)}));